---
name: Q&A Review UI - LABEL Stage Frontend
status: open
created: 2026-02-06T16:44:03Z
updated: 2026-02-06T16:44:03Z
github: [Will be updated when synced to GitHub]
depends_on: [001, 005]
parallel: false
conflicts_with: []
---

# Task: Q&A Review UI - LABEL Stage Frontend

## Description

Build the React frontend for the LABEL stage where experts review, approve, edit, and reject Q&A pairs. This is the primary expert touchpoint for quality control. The UI must support multimodal display (images, PDFs, tables), inline editing, bulk operations, and clearly distinguish pre-approved pairs (from canonical labels) from pairs needing review.

**User Workflow:**
1. Expert navigates to LABEL stage
2. Sees list of Training Sheets with review status (X labeled / Y total)
3. Clicks Training Sheet â†’ sees Q&A pairs
4. For each pair:
   - View: Question + Answer + Source Data (image/PDF/table)
   - Actions: Approve âœ“ | Edit âœï¸ | Reject âœ— | Flag ğŸš©
5. Pre-approved pairs (canonical labels) shown with green checkmark (skip review)
6. Edited pairs create new canonical label automatically

## Acceptance Criteria

- [ ] React component `LabelStage.tsx` for main stage page
- [ ] Component `TrainingSheetList.tsx` shows all Training Sheets with review statistics
- [ ] Component `QAPairReviewer.tsx` displays individual Q&A pair with actions
- [ ] Component `MultimodalDisplay.tsx` renders images, PDFs, tables based on item type
- [ ] Inline editing of assistant response
- [ ] Bulk selection and batch approve/reject
- [ ] Filter by status: all, unlabeled, labeled, rejected, flagged
- [ ] Keyboard shortcuts: A (approve), E (edit), R (reject), F (flag), â†’ (next), â† (prev)
- [ ] Visual indicator for pre-approved pairs (canonical label badge)
- [ ] Progress tracking: "45 / 100 reviewed (45%)"

## Technical Details

**Component Structure:**
```
frontend/src/pages/
â””â”€â”€ LabelStage.tsx

frontend/src/components/label/
â”œâ”€â”€ TrainingSheetList.tsx        # List of Training Sheets
â”œâ”€â”€ QAPairReviewer.tsx           # Individual Q&A pair review
â”œâ”€â”€ MultimodalDisplay.tsx        # Image/PDF/table rendering
â”œâ”€â”€ QAPairActions.tsx            # Action buttons (Approve/Edit/Reject/Flag)
â”œâ”€â”€ InlineEditor.tsx             # Edit assistant response
â”œâ”€â”€ BulkActionsBar.tsx           # Batch operations
â””â”€â”€ ProgressIndicator.tsx        # Review progress display
```

**API Integration:**
```typescript
// frontend/src/services/api.ts
export const labelingApi = {
  getTrainingSheet(id: string): Promise<TrainingSheet>
  getQAPairs(trainingSheetId: string, filters?: QAPairFilters): Promise<QAPair[]>
  approveQAPair(id: string): Promise<QAPair>
  editQAPair(id: string, newContent: string): Promise<QAPair>
  rejectQAPair(id: string, reason?: string): Promise<QAPair>
  flagQAPair(id: string, note: string): Promise<QAPair>
  bulkApprove(ids: string[]): Promise<void>
  bulkReject(ids: string[]): Promise<void>
}
```

**TypeScript Types:**
```typescript
// frontend/src/types/training.ts
export interface TrainingSheet {
  id: string
  sheet_id: string
  template_id: string
  status: "generating" | "review" | "approved" | "trained"
  total_pairs: number
  labeled_pairs: number
  unlabeled_pairs: number
  rejected_pairs: number
  flagged_pairs: number
}

export interface QAPair {
  id: string
  training_sheet_id: string
  messages: Message[]
  status: "unlabeled" | "labeled" | "rejected" | "flagged"
  labeling_mode: "canonical" | "ai_generated" | "manual" | "existing_column"
  canonical_label_id?: string  // If pre-approved
  allowed_uses: string[]
  prohibited_uses: string[]
}

export interface Message {
  role: "system" | "user" | "assistant"
  content: string | MultimodalContent
}

export interface MultimodalContent {
  type: "text" | "image" | "table" | "pdf"
  data: string | object
}
```

**Multimodal Display Logic:**
```typescript
// Detect content type and render appropriately
if (message.content.type === "image") {
  return <img src={message.content.data} />
}
if (message.content.type === "pdf") {
  return <PDFViewer url={message.content.data} />
}
if (message.content.type === "table") {
  return <TableDisplay data={message.content.data} />
}
```

**Files to Create:**
```
frontend/src/
â”œâ”€â”€ pages/LabelStage.tsx
â”œâ”€â”€ components/label/
â”‚   â”œâ”€â”€ TrainingSheetList.tsx
â”‚   â”œâ”€â”€ QAPairReviewer.tsx
â”‚   â”œâ”€â”€ MultimodalDisplay.tsx
â”‚   â”œâ”€â”€ QAPairActions.tsx
â”‚   â”œâ”€â”€ InlineEditor.tsx
â”‚   â”œâ”€â”€ BulkActionsBar.tsx
â”‚   â””â”€â”€ ProgressIndicator.tsx
â”œâ”€â”€ services/api.ts (update)
â””â”€â”€ types/training.ts
```

## Dependencies

- [ ] Task 005 (Q&A Generation Engine - provides data)
- [ ] React Router configured for stage navigation
- [ ] Tailwind CSS for styling
- [ ] PDF viewer library (e.g., `react-pdf`)
- [ ] Backend API endpoints for Q&A pair updates

## Effort Estimate

- Size: XL
- Hours: 24-32 hours
- Parallel: false (depends on Task 005)

## Definition of Done

- [ ] All components implemented and styled with Tailwind
- [ ] Q&A pairs displayed with correct formatting
- [ ] Actions (Approve/Edit/Reject/Flag) work and update backend
- [ ] Multimodal display renders images correctly (test with sample PCB images)
- [ ] Inline editing updates assistant response
- [ ] Bulk operations work (select 10 pairs, batch approve)
- [ ] Keyboard shortcuts functional
- [ ] Pre-approved pairs show canonical label badge
- [ ] Progress indicator accurate
- [ ] TypeScript quality hooks pass (no type errors)
- [ ] Manual test: Review 20 Q&A pairs, approve 15, edit 3, reject 2
- [ ] Frontend CLAUDE.md updated with LABEL stage patterns
